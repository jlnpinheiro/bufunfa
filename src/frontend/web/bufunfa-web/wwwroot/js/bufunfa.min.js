var Bufunfa=function(){var n=function(){window.Lancamento!=null?window.Lancamento.atualizar():window.Agendamento!=null?window.Agendamento.atualizar():window.Dashboard!=null?window.Dashboard.atualizar():window.Conta!=null&&window.Conta.atualizar()},t=function(n,t){t=numeral(t).value();let i=new CountUp(n,t,{decimalPlaces:2,duration:.5,separator:".",decimal:",",prefix:"R$ "});i.start()},v=function(t){AppModal.exibirPorRota("/agendamentos/descartar-parcela?idParcela="+t,function(){$("#form-descartar-parcela").validate({submitHandler:function(){let t={Id:$("#iIdParcela").val(),MotivoDescarte:$("#iMotivo").val()};AppModal.exibirConfirmacao("Deseja realmente descartar essa parcela?","Sim","Não",function(){$.post(App.corrigirPathRota("/agendamentos/descartar-parcela"),{entrada:t}).done(function(t){let r=Feedback.converter(t);r.tipo=="SUCESSO"?(AppModal.ocultar(),r.exibir(function(){n();i($("#iIdAgendamento").val())})):r.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})})}})})},y=function(t){AppModal.exibirPorRota("/agendamentos/lancar-parcela?idAgendamento="+$("#iIdAgendamento").val()+"&idParcela="+t,function(){$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});$("#iLancamentoData").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa"});$("#iLancamentoValor").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:""});$("#form-lancar-parcela").validate({rules:{iLancamentoData:{required:!0},iLancamentoValor:{required:!0}},submitHandler:function(){let t={Id:$("#iIdParcela").val(),Data:$("#iLancamentoData").val(),Valor:$("#iLancamentoValor").val(),Observacao:$("#iObservacao").val()};AppModal.exibirConfirmacao("Deseja realmente lançar essa parcela?","Sim","Não",function(){$.post(App.corrigirPathRota("/agendamentos/lancar-parcela"),{entrada:t}).done(function(t){let r=Feedback.converter(t);r.tipo=="SUCESSO"?(AppModal.ocultar(),r.exibir(function(){n();i($("#iIdAgendamento").val())})):r.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})})}})})},e=function(t){let r=t===null||t===undefined||t===0;AppModal.exibirPorRota(r?App.corrigirPathRota("/agendamentos/cadastrar-parcela"):App.corrigirPathRota("/agendamentos/alterar-parcela?idAgendamento="+$("#iIdAgendamento").val()+"&idParcela="+t),function(){$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});$("#iParcelaData").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa"});$("#iParcelaValor").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:""});$("#form-manter-parcela").validate({rules:{iParcelaData:{required:!0},iParcelaValor:{required:!0}},submitHandler:function(){let t={Id:$("#iIdParcela").val(),IdAgendamento:$("#iIdAgendamento").val(),Data:$("#iParcelaData").val(),Valor:$("#iParcelaValor").val(),Observacao:$("#iParcelaObservacao").val()};$.post(App.corrigirPathRota(r?"/agendamentos/cadastrar-parcela":"/agendamentos/alterar-parcela"),{entrada:t}).done(function(t){let r=Feedback.converter(t);r.tipo=="SUCESSO"?(AppModal.ocultar(),r.exibir(function(){n();i($("#iIdAgendamento").val())})):r.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})}})})},p=function(t){$.post(App.corrigirPathRota("/agendamentos/excluir-parcela?idParcela="+t),function(t){let r=Feedback.converter(t);r.tipo=="SUCESSO"&&(n(),i($("#iIdAgendamento").val()));r.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})},o=function(){App.aplicarTabelaSelecionavel("#table-parcelas");$("#btn-cadastrar-parcela").click(function(){e(null)});$("a[class*='alterar-parcela']").each(function(){let n=$(this).data("id-parcela");$(this).click(function(t){t.preventDefault();e(n)})});$("a[class*='descartar-parcela']").each(function(){let n=$(this).data("id-parcela");$(this).click(function(t){t.preventDefault();v(n)})});$("a[class*='lancar-parcela']").each(function(){let n=$(this).data("id-parcela");$(this).click(function(t){t.preventDefault();y(n)})});$("a[class*='excluir-parcela']").each(function(){let n=$(this).data("id-parcela");$(this).click(function(t){t.preventDefault();AppModal.exibirConfirmacao("Deseja realmente excluir essa parcela?","Sim","Não",function(){p(n)})})});$(".table-responsive").on("show.bs.dropdown",function(){$(".table-responsive").css("overflow","inherit")});$(".table-responsive").on("hide.bs.dropdown",function(){$(".table-responsive").css("overflow","auto")});KTApp.initTooltips()},i=function(n){$.get(App.corrigirPathRota("/agendamentos/listar-parcelas-por-agendamento?idAgendamento="+n),function(n){$("#divParcelas").html(n)}).done(function(){o()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})},s=function(t){let r=t===null||t===undefined||t===0;AppModal.exibirPorRota(r?App.corrigirPathRota("/agendamentos/cadastrar-agendamento"):App.corrigirPathRota("/agendamentos/alterar-agendamento?id="+t),function(){$(".datepicker").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa",clearIncomplete:!0});Bufunfa.criarSelectContasCartoesCredito({selector:"#sAgendamentoConta",dropDownParentSelector:".jconfirm",obrigatorio:!0,callbacks:{selecionar:function(){if($("#sAgendamentoConta").find(":selected").data("tipo")=="CC"){$("#sAgendamentoMetodo").val("2");$("#sAgendamentoMetodo").trigger("change");$("#sAgendamentoMetodo").attr("disabled",!0);$("#sAgendamentoPeriodicidade").val("1");$("#sAgendamentoPeriodicidade").trigger("change");$("#sAgendamentoPeriodicidade").attr("disabled",!0);$("#iAgendamentoDataPrimeiraParcela").datepicker("destroy");let n=$($("#sAgendamentoConta").select2("data")[0].element).data("dia-vencimento-fatura");$("#iAgendamentoDataPrimeiraParcela").inputmask("remove").inputmask({alias:"datetime",inputFormat:n+"/mm/yyyy",placeholder:"dd/mm/aaaa"})}else $("#sAgendamentoMetodo").attr("disabled",!1),$("#sAgendamentoPeriodicidade").attr("disabled",!1),$("#iAgendamentoDataPrimeiraParcela").inputmask("remove").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa"}),$("#iAgendamentoDataPrimeiraParcela").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0})}}});Bufunfa.criarSelectCategorias({selector:"#sAgendamentoCategoria",dropDownParentSelector:".jconfirm",obrigatorio:!0});Bufunfa.criarSelectPessoa({selector:"#sAgendamentoPessoa",dropDownParentSelector:".jconfirm",permitirCadastro:!0,obrigatorio:!1});$("#sAgendamentoMetodo").select2({allowClear:!1,placeholder:"Selecione um método",dropdownParent:$(".jconfirm"),minimumResultsForSearch:-1});$("#sAgendamentoPeriodicidade").select2({allowClear:!1,placeholder:"Selecione uma frequência",dropdownParent:$(".jconfirm"),minimumResultsForSearch:-1});$("#iAgendamentoQuantidadeParcelas").inputmask({mask:"9",repeat:3,greedy:!1});$("#iAgendamentoValorParcela").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:""});$("#form-manter-agendamento").validate({rules:{sAgendamentoConta:{required:!0},sAgendamentoCategoria:{required:!0},sAgendamentoMetodo:{required:!0},sAgendamentoPeriodicidade:{required:!0},iAgendamentoQuantidadeParcelas:{required:!0},iAgendamentoDataPrimeiraParcela:{required:!0},iAgendamentoValorParcela:{required:!0}},submitHandler:function(){let u={Id:$("#iIdAgendamento").val(),IdCartaoCredito:$("#sAgendamentoConta").find(":selected").data("tipo")==="CC"?$("#sAgendamentoConta").val():null,IdConta:$("#sAgendamentoConta").find(":selected").data("tipo")!=="CC"?$("#sAgendamentoConta").val():null,IdCategoria:$("#sAgendamentoCategoria").val(),IdPessoa:$("#sAgendamentoPessoa").val(),NomePessoa:$("#sAgendamentoPessoa").select2("data")[0]!=null?$("#sAgendamentoPessoa").select2("data")[0].text:null,TipoMetodoPagamento:$("#sAgendamentoMetodo").val(),Observacao:$("#iAgendamentoObservacao").val(),ValorParcela:$("#iAgendamentoValorParcela").val(),DataPrimeiraParcela:$("#iAgendamentoDataPrimeiraParcela").val(),QuantidadeParcelas:$("#iAgendamentoQuantidadeParcelas").val(),PeriodicidadeParcelas:$("#sAgendamentoPeriodicidade").val()};$.post(App.corrigirPathRota(r?"/agendamentos/cadastrar-agendamento":"/agendamentos/alterar-agendamento"),{entrada:u}).done(function(u){let f=Feedback.converter(u);f.tipo=="SUCESSO"?(r?AppModal.ocultar(!0):i(t),f.exibir(function(){n()})):f.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})}});r||($("#sAgendamentoConta").trigger("change"),$("#sAgendamentoConta").attr("disabled",!0),$("a[href='#aba-parcelas']").click(function(){$("#btn-salvar-agendamento").hide()}),$("a[href='#aba-info']").click(function(){$("#btn-salvar-agendamento").show()}),$("#btn-salvar-agendamento").click(function(){$("#form-manter-agendamento").submit()}),o())},!0,"manter-agendamento")},h=function(n){AppModal.exibirPorRota(App.corrigirPathRota("/cartoes/consultar-fatura"),function(){$("#form-procurar-fatura").validate({rules:{sCartaoCreditoFatura:{required:!0},sMesFatura:{required:!0},iAnoFatura:{required:!0,min:2019}},submitHandler:function(){l($("#sCartaoCreditoFatura").val(),$("#sMesFatura").val(),$("#iAnoFatura").val())}});Bufunfa.criarSelectContasCartoesCredito({selector:"#sCartaoCreditoFatura",dropDownParentSelector:".jconfirm",obrigatorio:!0});n!==null&&n!==undefined&&$("#sCartaoCreditoFatura").val(n).trigger("change");$("#sMesFatura").select2({allowClear:!1,placeholder:"Selecione um mês",dropdownParent:$(".jc-bs3-container")}).on("change",function(){$(this).valid()});$("#iAnoFatura").inputmask({mask:"9",repeat:4,greedy:!1})})},c=function(n){KTApp.initTooltips();$("#bConsultarFatura").click(function(){AppModal.ocultar(!0);h(n)});$("#bPagarFatura").click(function(){b()});$("#iValorCreditoAdicionalFatura").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:"",allowPlus:!1,allowMinus:!1});$("#iValorDebitoAdicionalFatura").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:"",allowPlus:!1,allowMinus:!1});$("#iValorCreditoAdicionalFatura").blur(function(){let n=u(),i=f();n<0?$("#span-valor-adicional-total").removeClass("kt-font-dark").removeClass("kt-font-success").addClass("kt-font-danger"):n==0?$("#span-valor-adicional-total").removeClass("kt-font-danger").removeClass("kt-font-success").addClass("kt-font-dark"):$("#span-valor-adicional-total").removeClass("kt-font-dark").removeClass("kt-font-danger").addClass("kt-font-success");t("span-valor-adicional-total",n);t("span-valor-total-fatura",i)});$("#iValorDebitoAdicionalFatura").blur(function(){let n=u(),i=f();n<0?$("#span-valor-adicional-total").removeClass("kt-font-dark").removeClass("kt-font-success").addClass("kt-font-danger"):n==0?$("#span-valor-adicional-total").removeClass("kt-font-danger").removeClass("kt-font-success").addClass("kt-font-dark"):$("#span-valor-adicional-total").removeClass("kt-font-dark").removeClass("kt-font-danger").addClass("kt-font-success");t("span-valor-adicional-total",n);t("span-valor-total-fatura",i)});$("button[class*='visualizar-agendamento']").each(function(){let n=$(this).data("id");$(this).click(function(){s(n)})})},l=function(n,t,i){AppModal.ocultar(!0);AppModal.exibirPorRota(App.corrigirPathRota("/cartoes/exibir-fatura?idCartao="+n+"&mes="+t+"&ano="+i),function(){c(n);App.aplicarTabelaSelecionavel("#table-parcelas")},!0,"exibir-fatura")},w=function(n){AppModal.ocultar(!0);AppModal.exibirPorRota(App.corrigirPathRota("/cartoes/exibir-fatura-por-lancamento?idLancamento="+n),function(){c()},!0,"exibir-fatura")},u=function(){let n=numeral($("#iValorCreditoAdicionalFatura").val()).value()==null?0:numeral($("#iValorCreditoAdicionalFatura").val()).value(),t=numeral($("#iValorDebitoAdicionalFatura").val()).value()==null?0:numeral($("#iValorDebitoAdicionalFatura").val()).value();return n-t},f=function(){let t=numeral($("#span-valor-total-parcelas").data("valor-total-parcelas")).value();var n=t+u();return n<0?n*-1:n},b=function(){AppModal.exibirPorRota(App.corrigirPathRota("/cartoes/pagar-fatura?valorFatura="+f()),function(){$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});$("#iLancamentoDataFatura").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa"});$("#form-pagar-fatura").validate({rules:{sLancamentoContaFatura:{required:!0},iLancamentoDataFatura:{required:!0},iLancamentoValorFatura:{required:!0}},submitHandler:function(){AppModal.exibirConfirmacao("Deseja realmente realizar o pagamento dessa fatura?","Sim","Não",function(){let t={IdCartaoCredito:$("#iIdCartaoCreditoFatura").val(),MesFatura:$("#iMesFatura").val(),AnoFatura:$("#iAnoFatura").val(),ValorAdicionalCredito:$("#iValorCreditoAdicionalFatura").val(),ObservacaoCredito:$("#iObservaoCreditoAdicionalFatura").val(),ValorAdicionalDebito:$("#iValorDebitoAdicionalFatura").val(),ObservacaoDebito:$("#iObservaoDebitoAdicionalFatura").val(),IdContaPagamento:$("#sLancamentoContaFatura").val(),IdPessoaPagamento:$("#sLancamentoPessoaFatura").val(),DataPagamento:$("#iLancamentoDataFatura").val(),ValorPagamento:$("#iLancamentoValorFatura").val()};$.post(App.corrigirPathRota("/cartoes/pagar-fatura"),{entrada:t}).done(function(t){let i=Feedback.converter(t);i.tipo=="SUCESSO"?(AppModal.ocultar(!0),i.exibir(function(){n()})):i.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})})}});Bufunfa.criarSelectContasCartoesCredito({selector:"#sLancamentoContaFatura",dropDownParentSelector:".jconfirm",obrigatorio:!0});Bufunfa.criarSelectPessoa({selector:"#sLancamentoPessoaFatura",dropDownParentSelector:".jconfirm",permitirCadastro:!1,obrigatorio:!1})})},k=function(n){AppModal.exibirPorRota(App.corrigirPathRota("/contas/informar-valor-cotacao-por-acao?id="+n),function(){$("#iValorCotacao").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:""});$("#form-valor-cotacao").validate({rules:{iValorCotacao:{required:!0}},submitHandler:function(){r(n,$("#iValorCotacao").val())}})})},r=function(n,t,i=true){AppModal.ocultar(i);(t==""||t==null||t==undefined)&&(t="0");AppModal.exibirPorRota(App.corrigirPathRota("/contas/obter-analise-por-ativo?id="+n+"&valorCotacao="+t.toString().replace(",",".")),function(){KTApp.initTooltips();KTApp.initPortlets();$(".obter-cotacao").click(function(){let n=$(this).data("id");$(this).click(function(){r(n)})});$(".informar-cotacao").click(function(){let n=$(this).data("id");k(n)});$(".btn-cadastrar-operacao").click(function(){let n=$(this).data("id-conta");a(n,null)});$("button[class*='alterar-operacao']").each(function(){let n=$(this).data("id");$(this).click(function(){a(null,n)})});$("button[class*='excluir-operacao']").each(function(){let n=$(this).data("id-conta"),t=$(this).data("id");$(this).click(function(){AppModal.exibirConfirmacao("Deseja realmente excluir esse operação?","Sim","Não",function(){d(n,t)})})});$(".btn-fechar-widget").click(function(){$("body").css("overflow","auto");AppModal.ocultarPorTitulo("popup-acao")})},!0,"popup-acao")},a=function(t,i){let u=i===null||i===undefined||i===0;AppModal.exibirPorRota(u?App.corrigirPathRota("/lancamentos/cadastrar-operacao?idConta="+t):App.corrigirPathRota("/lancamentos/alterar-operacao?id="+i),function(){$("#form-manter-operacao").validate({rules:{iData:{required:!0},sCategoria:{required:!0},iValorTotal:{required:!0}},submitHandler:function(){let t={Id:$("#iIdLancamento").val(),IdConta:$("#iIdConta").val(),IdCategoria:$("#sCategoria").val(),Data:$("#iData").val(),Valor:$("#iValorTotal").val(),QuantidadeAcoes:$("#iQuantidade").val()};$.post(App.corrigirPathRota(u?"/lancamentos/cadastrar-operacao":"/lancamentos/alterar-operacao"),{entrada:t}).done(function(t){let i=Feedback.converter(t);i.tipo=="SUCESSO"?i.exibir(function(){r($("#iIdConta").val());n()}):i.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})}});$("#sCategoria").select2({allowClear:!1,placeholder:"Selecione uma categoria",dropdownParent:$(".jc-bs3-container"),minimumResultsForSearch:-1,escapeMarkup:function(n){return n},templateResult:function(n){return'<i class="fa fa-tag '+($(n.element).data("tipo")=="C"?"kt-font-success":"kt-font-danger")+'"><\/i>  '+n.text},templateSelection:function(n){return n.id===""?"Selecione uma categoria":'<i class="fa fa-tag '+($(n.element).data("tipo")=="C"?"kt-font-success":"kt-font-danger")+'"><\/i> '+n.text}}).on("change",function(){$(this).val()==="5"||$(this).val()==="6"?($("#divRowQuantidade").show(),$("#iQuantidade").rules("add",{required:!0,min:1})):($("#divRowQuantidade").hide(),$("#iQuantidade").rules("remove"))});$("#iIdCategoria").val()!=""&&($("#sCategoria").val($("#iIdCategoria").val()),$("#sCategoria").trigger("change"));$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});$(".datepicker").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa",clearIncomplete:!0});$("#iValorTotal").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:""});$("#iQuantidade").inputmask({mask:"9",repeat:3,greedy:!1})})},d=function(n,t){$.post(App.corrigirPathRota("/lancamentos/excluir-operacao?id="+t),function(t){let i=Feedback.converter(t);i.tipo=="SUCESSO"?i.exibir(function(){r(n)}):i.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})},g=function(n,t,i,r,u){u?location.href=App.corrigirPathRota("/relatorios/gerar-extrato-por-periodo?dataInicio="+i+"&dataFim="+r+"&idConta="+n+"&idPeriodo="+t+"&gerarPdf=true"):AppModal.exibirPorRota(App.corrigirPathRota("/relatorios/gerar-extrato-por-periodo?dataInicio="+i+"&dataFim="+r+"&idConta="+n+"&idPeriodo="+t+"&gerarPdf=false"),function(){App.aplicarTabelaSelecionavel("#table-relatorio");$("#btnGerarPdf").click(function(){location.href=App.corrigirPathRota("/relatorios/gerar-extrato-por-periodo?dataInicio="+i+"&dataFim="+r+"&idConta="+n+"&idPeriodo="+t+"&gerarPdf=true")})})},nt=function(n,t){$.get(App.corrigirPathRota("/graficos/ober-dados-grafico-valor-por-categoria?idCategoria="+n+"&ano="+t),function(i){AppModal.exibirPorRota(App.corrigirPathRota("/graficos/exibir-popup-grafico-valor-por-categoria?idCategoria="+n+"&ano="+t),function(){let r=[];$.each(i.periodos,function(n,t){r.push({id:t.periodo.id,periodo:t.periodo.nome,total:t.valorTotal})});new Morris.Line({element:"div-grafico-valor-por-categoria",data:r,resize:!0,gridTextFamily:"Poppins",lineColors:["#367FA9"],pointFillColors:["#3C8DBC"],xLabelAngle:10,preUnits:"R$ ",parseTime:!1,xkey:"periodo",ykeys:["total"],labels:["Total: R$ "],goals:[i.valorMedio],goalLineColors:["#333"],hoverCallback:function(n,t,i,r){return'<span class="kt-font-bolder">'+r.periodo+'<\/span><br/><span class="kt-font-bold kt-font-primary">Total: '+numeral(r.total).format("$0,0.00")+"<\/span>"}}).on("click",function(i,r){AppModal.exibirPorRota(App.corrigirPathRota("/graficos/exibir-popup-periodo-grafico-valor-por-categoria?idPeriodo="+r.id+"&idCategoria="+n+"&ano="+t),function(){KTApp.initPortlets();App.aplicarTabelaSelecionavel("#tblLancamentosDetalhe");App.aplicarTabelaSelecionavel("#tblDetalhesDetalhe");App.aplicarTabelaSelecionavel("#tblParcelasDetalhe")})});$("#span-grafico-valor-por-categoria-ano").html(t);$("#span-grafico-valor-por-categoria-caminho").html('<i class="fa fa-tag kt-font-'+(i.categoria.tipo=="C"?"success":"danger")+'"><\/i> '+i.categoria.caminho);$("#span-grafico-valor-por-categoria-valor-medio").html(numeral(i.valorMedio).format("$0,0.00"))})}).done(function(){}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})};return{alterarSenhaUsuario:function(){AppModal.exibirPorRota(App.corrigirPathRota("usuario/alterar-senha"),function(){$.validator.addMethod("confirmar_senha",function(){return $("#iNovaSenha").val()===$("#iConfirmarNovaSenha").val()},"A senha digitada é diferente da informada no campo acima.");$("#form-alterar-senha").validate({rules:{iSenhaAtual:{required:!0,minlength:2,maxlength:8},iNovaSenha:{required:!0,minlength:2,maxlength:8},iConfirmarNovaSenha:{required:!0,confirmar_senha:!0,minlength:2,maxlength:8}},submitHandler:function(){$.post(App.corrigirPathRota("usuario/alterar-senha"),{senhaAtual:$("#iSenhaAtual").val(),novaSenha:$("#iNovaSenha").val(),confirmarNovaSenha:$("#iConfirmarNovaSenha").val()}).done(function(n){let t=Feedback.converter(n);t.tipo=="SUCESSO"?(AppModal.ocultar(),t.exibir()):t.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})}})})},aplicarEfeitoContagem:function(n,i){t(n,i)},obterSaldoAtual:function(n,i){$.get(App.corrigirPathRota("contas/obter-saldo-atual?id="+n),function(n){$(i).html(n)}).done(function(){t("span-saldo-atual",$("#span-saldo-atual").data("valor"))}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})},criarSelectContasCartoesCredito:function(n){let t=$(n.selector).data("tipo-item");$(n.selector).select2({dropdownParent:n!==null&&n.dropDownParentSelector!==null?$(n.dropDownParentSelector):null,language:"pt-BR",minimumResultsForSearch:-1,allowClear:n==null||!n.obrigatorio,placeholder:"",escapeMarkup:function(n){return n},templateResult:function(n){if(n.loading)return'<span class="kt-font-bold">'+n.text+"<\/span>";if($(n.element).data("tipo")=="CC"){let t=numeral($(n.element).data("limite-disponivel"));return'<div class="row"><div class="col-sm-9"><span class="kt-font-bolder"><i class="fa fa-credit-card"><\/i> '+n.text+'<\/span><\/div><div class="col-sm-3"><div class="text-right" style="font-size:11px;">Limite disponível<br><span class="kt-font-'+(t.value()>=0?"success":"danger")+'">'+t.format("$0,0.00")+"<\/div><\/div><\/div>"}let t=numeral($(n.element).data("saldo-atual"));return'<div class="row"><div class="col-sm-9"><span class="kt-font-bolder"><i class="fa fa-university" style="color:'+$(n.element).data("cor")+';"><\/i> '+n.text+'<\/span><div style="font-size:11px; line-height:12px;" class="kt-pt5">'+$(n.element).data("banco")+'<br/><\/div><\/div><div class="col-sm-3"><div class="text-right" style="font-size:11px;">Saldo atual<br><span class="kt-font-'+(t.value()>=0?"success":"danger")+'">'+t.format("$0,0.00")+"<\/div><\/div><\/div>"},templateSelection:function(n){return n.id===""?t=="1"?"Selecione uma conta ou cartão":t=="2"?"Selecione uma conta.":"Selecione um cartão de crédito.":$(n.element).data("tipo")=="CC"?'<span class="kt-font-bolder"><i class="fa fa-credit-card"><\/i> '+n.text+"<\/span>":'<span class="kt-font-bolder"><i class="fa fa-university" style="color:'+$(n.element).data("cor")+';"><\/i> '+n.text+"<\/span>"}}).on("change",function(){n!=null&&n.callbacks!=null&&n.callbacks.selecionar!=null&&n.callbacks.selecionar();$(this).valid()})},criarSelectCategorias:function(n){$(n.selector).select2({dropdownParent:n!==null&&n.dropDownParentSelector!==null?$(n.dropDownParentSelector):null,language:"pt-BR",allowClear:n==null||!n.obrigatorio,placeholder:"",escapeMarkup:function(n){return n},templateResult:function(n){return n.loading?'<span class="kt-font-bold">'+n.text+"<\/span>":($(n.element).data("tipo")=="C"?'<i class="fa fa-tag kt-font-success kt-font-sm"><\/i> ':'<i class="fa fa-tag kt-font-danger kt-font-sm"><\/i> ')+($(n.element).data("possui-filhas")=="1"?'<span class="kt-font-bolder">'+$(n.element).data("caminho")+"<\/span>":$(n.element).data("caminho"))},templateSelection:function(n){return n.id===""?"Selecione uma categoria":'<i class="fa fa-tag '+($(n.element).data("tipo")=="C"?"kt-font-success kt-font-sm":"kt-font-danger kt-font-sm")+'"><\/i> <span class="kt-font-bold">'+$(n.element).data("caminho")+"<\/span>"}}).on("change",function(){$(this).valid()})},criarSelectPeriodo:function(n){$(n.selector).select2({dropdownParent:n!==null&&n.dropDownParentSelector!==null?$(n.dropDownParentSelector):null,minimumInputLength:3,ajax:{url:App.corrigirPathRota("/periodos/obter-periodos-por-palavra-chave"),dataType:"json",delay:500,data:function(n){return{palavraChave:n.term}},processResults:function(n){let t=[];return t.push({id:"",text:""}),$.each(n,function(n,i){t.push({id:i.id,text:i.nome,dataInicio:i.dataInicio,dataFim:i.dataFim,quantidadeDias:i.quantidadeDias})}),{results:t}},cache:!0},language:"pt-BR",allowClear:n==null||!n.obrigatorio,placeholder:"Selecione um período",escapeMarkup:function(n){return n},templateResult:function(n){return n.loading?'<i class="fa fa-spinner fa-spin"><\/i> <span class="kt-font-bold">'+n.text+"<\/span>":'<span class="kt-font-boldest kt-font-primary">'+n.text+'<\/span> &raquo; <small class="kt-font-bolder">'+n.quantidadeDias+' dias<\/small><br/><div style="font-size:11px; line-height:15px;" class="kt-pt3">Início: '+n.dataInicio+"<br/>Término: "+n.dataFim+"<\/div>"},templateSelection:function(n){return n.id===""?"Selecione um período":'<span class="kt-font-bold">'+n.text+"<\/span>"}}).on("change",function(){n!=null&&n.callbacks.selecionar!=null&&n.callbacks.selecionar();$(this).valid()})},criarSelectPessoa:function(n){$(n.selector).select2({dropdownParent:n!==null&&n.dropDownParentSelector!==null?$(n.dropDownParentSelector):null,minimumInputLength:2,ajax:{url:App.corrigirPathRota("/pessoas/obter-pessoas-por-palavra-chave"),dataType:"json",delay:700,data:function(n){return{palavraChave:n.term}},processResults:function(t,i){let r=[];if(r.push({id:"",text:""}),$.each(t,function(n,t){r.push({id:t.id,text:t.nome})}),n!==null&&n.permitirCadastro&&i.term!=null){let n=!1;$.each(t,function(t,r){if(r.nome.toUpperCase()==i.term.toUpperCase())return n=!0,!1});n||r.push({id:0,text:i.term})}return{results:r}},cache:!0},language:"pt-BR",allowClear:n==null||!n.obrigatorio,placeholder:"Selecione uma pessoa",escapeMarkup:function(n){return n},templateResult:function(t){return t.loading?'<i class="fa fa-spinner fa-spin"><\/i> <span class="kt-font-bold">'+t.text+"<\/span>":n!==null&&n.permitirCadastro&&t.id==0?t.text+' <span class="kt-badge kt-badge--success kt-badge--inline kt-badge--pill kt-badge--rounded">cadastrar<\/span>':t.text},templateSelection:function(n){return n.id===""?"Selecione uma pessoa":'<span class="kt-font-bold">'+n.text+"<\/span>"}}).on("change",function(){$(this).valid()})},exibirPopupSelecaoContaLancamento:function(){AppModal.exibirPorRota(App.corrigirPathRota("/contas/popup-contas-lancamento"),function(){Bufunfa.criarSelectContasCartoesCredito({selector:"#sContaLancamento",obrigatorio:!0,dropDownParentSelector:".jconfirm",callbacks:{selecionar:function(){location.href=App.corrigirPathRota("/lancamentos?id="+$("#sContaLancamento").val())}}})})},manterLancamento:function(t,i,r){let u=i===null||i===undefined||i===0;AppModal.exibirPorRota(u?App.corrigirPathRota("/lancamentos/cadastrar-lancamento?idConta="+t):App.corrigirPathRota("/lancamentos/alterar-lancamento?id="+i),function(){$("#form-manter-lancamento").validate({rules:{sLancamentoConta:{required:!0},iLancamentoData:{required:!0},sLancamentoCategoria:{required:!0},iLancamentoValor:{required:!0}},submitHandler:function(){let t={Id:$("#iLancamentoId").val(),IdConta:$("#sLancamentoConta").val(),IdCategoria:$("#sLancamentoCategoria").val(),IdPessoa:$("#sLancamentoPessoa").val(),NomePessoa:$("#sLancamentoPessoa").select2("data")[0]!=null?$("#sLancamentoPessoa").select2("data")[0].text:null,Data:$("#iLancamentoData").val(),Valor:$("#iLancamentoValor").val(),Observacao:$("#iLancamentoObservacao").val()};$.post(App.corrigirPathRota(u?"/lancamentos/cadastrar-lancamento":"/lancamentos/alterar-lancamento"),{entrada:t}).done(function(t){let i=Feedback.converter(t);i.tipo=="SUCESSO"&&AppModal.ocultar(!0);i.exibir(function(){n();r!=null&&r.callbacks.salvar!=null&&r.callbacks.salvar()})}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})}});$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});$(".datepicker").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa",clearIncomplete:!0});Bufunfa.criarSelectContasCartoesCredito({selector:"#sLancamentoConta",dropDownParentSelector:".jconfirm",obrigatorio:!0});r==null||r.permitirSelecao||$("#sLancamentoConta").prop("disabled",!0);Bufunfa.criarSelectCategorias({selector:"#sLancamentoCategoria",dropDownParentSelector:".jconfirm",obrigatorio:!0});Bufunfa.criarSelectPessoa({selector:"#sLancamentoPessoa",dropDownParentSelector:".jconfirm",permitirCadastro:!0,obrigatorio:!1});$("#iLancamentoValor").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:""})},!0,"manter-lancamento")},manterAgendamento:function(n){s(n)},realizarTransferencia:function(){AppModal.exibirPorRota(App.corrigirPathRota("/contas/realizar-transferencia"),function(){$.validator.addMethod("origem_destino_diferentes",function(){return $("#sTransferenciaContaOrigem").val()!==$("#sTransferenciaContaDestino").val()},"As contas de origem e destino não podem ser iguais.");$("#form-transferir").validate({rules:{sTransferenciaContaOrigem:{origem_destino_diferentes:!0,required:!0},sTransferenciaContaDestino:{origem_destino_diferentes:!0,required:!0},iTransferenciaData:{required:!0},iTransferenciaValor:{required:!0}},submitHandler:function(){let t={IdContaOrigem:$("#sTransferenciaContaOrigem").val(),IdContaDestino:$("#sTransferenciaContaDestino").val(),Data:$("#iTransferenciaData").val(),Valor:$("#iTransferenciaValor").val(),Observacao:$("#iTransferenciaObservacao").val()};$.post(App.corrigirPathRota("/contas/realizar-transferencia"),{entrada:t}).done(function(t){let i=Feedback.converter(t);i.tipo=="SUCESSO"&&AppModal.ocultar();i.exibir(function(){n()})}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})}});$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});$(".datepicker").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa",clearIncomplete:!0});Bufunfa.criarSelectContasCartoesCredito({selector:"#sTransferenciaContaOrigem",dropDownParentSelector:".jconfirm",obrigatorio:!0});Bufunfa.criarSelectContasCartoesCredito({selector:"#sTransferenciaContaDestino",dropDownParentSelector:".jconfirm",obrigatorio:!0});$("#iTransferenciaValor").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:""})})},consultarFatura:function(n){h(n)},exibirFatura:function(n,t,i){l(n,t,i)},exibirFaturaPorLancamento:function(n){w(n)},exibirAcao:function(n,t=true){r(n,null,t)},detalharPeriodoAtual:function(){AppModal.exibirPorRota(App.corrigirPathRota("/periodos/detalhar-periodo-atual"),function(){$("#meterDias").liquidMeter({color:"#3C8DBC",background:"#282733",stroke:"#201F2B",fontFamily:"Poppins",fontSize:"26px",fontWeight:"500",textColor:"#FFFFFF",liquidOpacity:.7,liquidPalette:["#0088CC"],speed:3e3,animate:!0});$("#meterDias").liquidMeter("set",$("#meterDias").data("percentual-conclusao"));$(".liquid-meter-wrapper > h6").html('<span class="kt-font-dark">'+$("#meterDias").data("percentual-conclusao")+"%<\/span> restando");var n=numeral($("#meterDias").data("qtd-dias-fim-periodo")).value();$(".liquid-meter > svg > text").html(n+(n>1?" dias":" dia"));$("#span-resta").html(n>1?"Restam":"Resta")})},pagarCom:function(){AppModal.exibirPorRota(App.corrigirPathRota("/agendamentos/pagar-com"),function(){$("#form-pagar-com").validate({rules:{sPagarComCartao:{required:!0},iPagarComDataCompra:{required:!0},sPagarComCategoria:{required:!0},iPagarComValorCompra:{required:!0}},submitHandler:function(){let t={IdCartaoCredito:$("#sPagarComCartao").val(),IdCategoria:$("#sPagarComCategoria").val(),NomePessoa:$("input[name='iPagarComPessoa']:checked").val(),DataCompra:$("#iPagarComDataCompra").val(),ValorCompra:$("#iPagarComValorCompra").val(),Observacao:$("#iPagarComObservacao").val()};$.post(App.corrigirPathRota("/agendamentos/pagar-com"),{entrada:t}).done(function(t){let i=Feedback.converter(t);i.tipo=="SUCESSO"&&AppModal.ocultar(!0);i.exibir(function(){n()})}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})}});$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});$(".datepicker").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa",clearIncomplete:!0});Bufunfa.criarSelectContasCartoesCredito({selector:"#sPagarComCartao",dropDownParentSelector:".jconfirm",obrigatorio:!0});Bufunfa.criarSelectCategorias({selector:"#sPagarComCategoria",dropDownParentSelector:".jconfirm",obrigatorio:!0});$("#iPagarComValorCompra").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,prefix:""})})},exibirPopupParametrosExtratoPorPeriodo:function(){AppModal.exibirPorRota(App.corrigirPathRota("/relatorios/exibir-parametros-extrato-por-periodo"),function(){$.validator.addMethod("periodo_valido",function(){let n=moment($("#iExtratoPorPeriodoDataInicio").val(),"DD/MM/YYYY").toDate(),t=moment($("#iExtratoPorPeriodoDataFim").val(),"DD/MM/YYYY").toDate();return n<=t},"Período inválido.");$("#form-parametros-extrato-por-periodo").validate({rules:{sExtratoPorPeriodoConta:{required:!0},iExtratoPorPeriodoDataInicio:{required:!0,periodo_valido:!0},iExtratoPorPeriodoDataFim:{required:!0,periodo_valido:!0}},submitHandler:function(){g($("#sExtratoPorPeriodoConta").val(),$("#sExtratoPorPeriodoPeriodo").val(),$("#iExtratoPorPeriodoDataInicio").val(),$("#iExtratoPorPeriodoDataFim").val(),!1)}});$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});Bufunfa.criarSelectContasCartoesCredito({selector:"#sExtratoPorPeriodoConta",dropDownParentSelector:".jconfirm",obrigatorio:!0});$(".datepicker").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa",clearIncomplete:!0});Bufunfa.criarSelectPeriodo({selector:"#sExtratoPorPeriodoPeriodo",dropDownParentSelector:".jconfirm",obrigatorio:!1,callbacks:{selecionar:function(){if($("#sExtratoPorPeriodoPeriodo").select2("data").length){let n,t=null;$("#sExtratoPorPeriodoPeriodo").select2("data")[0].dataInicio!=null&&$("#sExtratoPorPeriodoPeriodo").select2("data")[0].dataFim!=null?(n=moment($("#sExtratoPorPeriodoPeriodo").select2("data")[0].dataInicio,"DD/MM/YYYY"),t=moment($("#sExtratoPorPeriodoPeriodo").select2("data")[0].dataFim,"DD/MM/YYYY")):(n=moment($("#sExtratoPorPeriodoPeriodo").find(":selected").attr("data-dataInicio"),"DD/MM/YYYY"),t=moment($("#sExtratoPorPeriodoPeriodo").find(":selected").attr("data-dataFim"),"DD/MM/YYYY"));$("#iExtratoPorPeriodoDataInicio").datepicker("update",n.format("DD-MM-YYYY"));$("#iExtratoPorPeriodoDataFim").datepicker("update",t.format("DD-MM-YYYY"));$("#iExtratoPorPeriodoDataInicio").attr("disabled",!0);$("#iExtratoPorPeriodoDataFim").attr("disabled",!0);$("#iExtratoPorPeriodoDataInicio").valid();$("#iExtratoPorPeriodoDataFim").valid()}else $("#iExtratoPorPeriodoDataInicio").datepicker("clearDates"),$("#iExtratoPorPeriodoDataFim").datepicker("clearDates"),$("#iExtratoPorPeriodoDataInicio").attr("disabled",!1),$("#iExtratoPorPeriodoDataFim").attr("disabled",!1)}}})})},exibirPopupParametrosGraficoValorPorCategoria:function(){AppModal.exibirPorRota(App.corrigirPathRota("/graficos/exibir-parametros-valor-por-categoria"),function(){$("#form-parametros-valor-por-categoria").validate({rules:{sGraficoValorPorCategoriaCategoria:{required:!0},iGraficoValorPorCategoriaAno:{required:!0}},submitHandler:function(){nt($("#sGraficoValorPorCategoriaCategoria").val(),$("#iGraficoValorPorCategoriaAno").val())}});Bufunfa.criarSelectCategorias({selector:"#sGraficoValorPorCategoriaCategoria",dropDownParentSelector:".jconfirm",obrigatorio:!0});$("#iGraficoValorPorCategoriaAno").inputmask({mask:"9999",greedy:!1})})}}}();