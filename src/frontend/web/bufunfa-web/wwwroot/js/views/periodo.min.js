var Periodo=function(){var t=function(){$("#tblPeriodo").DataTable({ajax:{url:App.corrigirPathRota("/periodos/listar-periodos"),type:"POST",error:function(n){let t=Feedback.converter(n.responseJSON);t.exibir()}},info:!0,columns:[{data:"nome",title:"Nome",orderable:!0,className:"all text-nowrap",render:function(n,t,i){return i.nome+' <span class="kt-badge kt-badge--dark kt-badge--dot kt-badge--sm"><\/span> <small class="kt-font-bolder kt-font-primary">'+i.quantidadeDias+" dias<\/small>"}},{data:"dataInicio",title:"Início em",orderable:!0,className:"all"},{data:"dataFim",title:"Término em",orderable:!0,className:"all"},{data:null,className:"text-center",orderable:!1,width:"1px",render:function(n,t,i){return'<button class="btn btn-clean btn-sm btn-icon btn-icon-sm btn-datatables alterar-periodo" data-id="'+i.id+'" data-toggle="kt-tooltip" data-boundary="window" data-placement="top" data-original-title="Alterar"><span class="la la-edit"><\/span><\/button>'}},{data:null,className:"text-center",orderable:!1,width:"1px",render:function(n,t,i){return'<button class="btn btn-clean btn-sm btn-icon btn-icon-sm btn-datatables excluir-periodo" data-id="'+i.id+'" data-toggle="kt-tooltip" data-boundary="window" data-placement="top" data-original-title="Excluir"><span class="la la-trash"><\/span><\/button>'}}],select:{style:"single",info:!1},serverSide:!0,responsive:!1,order:[1,"desc"],searching:!0,paging:!0,pageLength:50,lengthChange:!0}).on("draw.dt",function(){KTApp.initTooltips();$("button[class*='alterar-periodo']").each(function(){let t=$(this).data("id");$(this).click(function(){n(t)})});$("button[class*='excluir-periodo']").each(function(){let n=$(this).data("id");$(this).click(function(){AppModal.exibirConfirmacao("Deseja realmente excluir esse período?","Sim","Não",function(){i(n)})})})})},n=function(n){let t=n===null||n===undefined||n===0;AppModal.exibirPorRota(t?App.corrigirPathRota("/periodos/cadastrar-periodo"):App.corrigirPathRota("/periodos/alterar-periodo?id="+n),function(){$.validator.addMethod("periodo_valido",function(){let n=moment($("#iDataInicio").val(),"DD/MM/YYYY").toDate(),t=moment($("#iDataFim").val(),"DD/MM/YYYY").toDate();return n<=t},"Período inválido.");$("#form-manter-periodo").validate({rules:{iNome:{required:!0},iDataInicio:{required:!0,periodo_valido:!0},iDataFim:{required:!0,periodo_valido:!0}},submitHandler:function(){let n={Id:$("#iIdPeriodo").val(),Nome:$("#iNome").val(),DataInicio:$("#iDataInicio").val(),DataFim:$("#iDataFim").val()};$.post(App.corrigirPathRota(t?"/periodos/cadastrar-periodo":"/periodos/alterar-periodo"),{entrada:n}).done(function(n){let t=Feedback.converter(n);t.tipo=="SUCESSO"?(AppModal.ocultar(),t.exibir(function(){$("#tblPeriodo").DataTable().ajax.reload()})):t.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})}});$(".datepicker").datepicker({autoclose:!0,language:"pt-BR",todayBtn:"linked",todayHighlight:!0});$(".datepicker").inputmask({alias:"datetime",inputFormat:"dd/mm/yyyy",placeholder:"dd/mm/aaaa",clearIncomplete:!0})})},i=function(n){$.post(App.corrigirPathRota("/periodos/excluir-periodo?id="+n),function(n){let t=Feedback.converter(n);t.tipo=="SUCESSO"?(AppModal.ocultar(),t.exibir(function(){$("#tblPeriodo").DataTable().ajax.reload()})):t.exibir()}).fail(function(n){let t=Feedback.converter(n.responseJSON);t.exibir()})};return{init:function(){t();$("#tblPeriodo_filter input").attr("placeholder","Procurar");$("#btn-cadastrar-periodo").click(function(){n()})}}}();jQuery(document).ready(function(){Periodo.init()});